{"ast":null,"code":"'use strict';\n\nvar extend = require('extend');\n\nvar isArray = require('util').isArray;\n\nvar isDate = require('util').isDate;\n\nvar sprintf = require(\"sprintf-js\").sprintf;\n\nvar events = require('events');\n\nvar except = require('except');\n\nvar strftime = require('./strftime');\n\nvar translationScope = 'counterpart';\n\nfunction isString(val) {\n  return typeof val === 'string' || Object.prototype.toString.call(val) === '[object String]';\n}\n\nfunction isFunction(val) {\n  return typeof val === 'function' || Object.prototype.toString.call(val) === '[object Function]';\n}\n\nfunction isPlainObject(val) {\n  //Deal with older browsers (IE8) that don't return [object Null] in this case.\n  if (val === null) {\n    return false;\n  }\n\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\nfunction isSymbol(key) {\n  return isString(key) && key[0] === ':';\n}\n\nfunction hasOwnProp(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction getEntry(translations, keys) {\n  return keys.reduce(function (result, key) {\n    if (isPlainObject(result) && hasOwnProp(result, key)) {\n      return result[key];\n    } else {\n      return null;\n    }\n  }, translations);\n}\n\nfunction Counterpart() {\n  events.EventEmitter.apply(this);\n  this._registry = {\n    locale: 'en',\n    interpolate: true,\n    fallbackLocales: [],\n    scope: null,\n    translations: {},\n    interpolations: {},\n    normalizedKeys: {},\n    separator: '.',\n    keepTrailingDot: false,\n    keyTransformer: function (key) {\n      return key;\n    },\n    generateMissingEntry: function (key) {\n      return 'missing translation: ' + key;\n    }\n  };\n  this.registerTranslations('en', require('./locales/en'));\n  this.setMaxListeners(0);\n}\n\nCounterpart.prototype = events.EventEmitter.prototype;\nCounterpart.prototype.constructor = events.EventEmitter;\n\nCounterpart.prototype.getLocale = function () {\n  return this._registry.locale;\n};\n\nCounterpart.prototype.setLocale = function (value) {\n  var previous = this._registry.locale;\n\n  if (previous != value) {\n    this._registry.locale = value;\n    this.emit('localechange', value, previous);\n  }\n\n  return previous;\n};\n\nCounterpart.prototype.getFallbackLocale = function () {\n  return this._registry.fallbackLocales;\n};\n\nCounterpart.prototype.setFallbackLocale = function (value) {\n  var previous = this._registry.fallbackLocales;\n  this._registry.fallbackLocales = [].concat(value || []);\n  return previous;\n};\n\nCounterpart.prototype.getAvailableLocales = function () {\n  return this._registry.availableLocales || Object.keys(this._registry.translations);\n};\n\nCounterpart.prototype.setAvailableLocales = function (value) {\n  var previous = this.getAvailableLocales();\n  this._registry.availableLocales = value;\n  return previous;\n};\n\nCounterpart.prototype.getSeparator = function () {\n  return this._registry.separator;\n};\n\nCounterpart.prototype.setSeparator = function (value) {\n  var previous = this._registry.separator;\n  this._registry.separator = value;\n  return previous;\n};\n\nCounterpart.prototype.setInterpolate = function (value) {\n  var previous = this._registry.interpolate;\n  this._registry.interpolate = value;\n  return previous;\n};\n\nCounterpart.prototype.getInterpolate = function () {\n  return this._registry.interpolate;\n};\n\nCounterpart.prototype.setKeyTransformer = function (value) {\n  var previous = this._registry.keyTransformer;\n  this._registry.keyTransformer = value;\n  return previous;\n};\n\nCounterpart.prototype.getKeyTransformer = function () {\n  return this._registry.keyTransformer;\n};\n\nCounterpart.prototype.setMissingEntryGenerator = function (value) {\n  var previous = this._registry.generateMissingEntry;\n  this._registry.generateMissingEntry = value;\n  return previous;\n};\n\nCounterpart.prototype.getMissingEntryGenerator = function () {\n  return this._registry.generateMissingEntry;\n};\n\nCounterpart.prototype.registerTranslations = function (locale, data) {\n  var translations = {};\n  translations[locale] = data;\n  extend(true, this._registry.translations, translations);\n  return translations;\n};\n\nCounterpart.prototype.registerInterpolations = function (data) {\n  return extend(true, this._registry.interpolations, data);\n};\n\nCounterpart.prototype.onLocaleChange = Counterpart.prototype.addLocaleChangeListener = function (callback) {\n  this.addListener('localechange', callback);\n};\n\nCounterpart.prototype.offLocaleChange = Counterpart.prototype.removeLocaleChangeListener = function (callback) {\n  this.removeListener('localechange', callback);\n};\n\nCounterpart.prototype.onTranslationNotFound = Counterpart.prototype.addTranslationNotFoundListener = function (callback) {\n  this.addListener('translationnotfound', callback);\n};\n\nCounterpart.prototype.offTranslationNotFound = Counterpart.prototype.removeTranslationNotFoundListener = function (callback) {\n  this.removeListener('translationnotfound', callback);\n};\n\nCounterpart.prototype.onError = Counterpart.prototype.addErrorListener = function (callback) {\n  this.addListener('error', callback);\n};\n\nCounterpart.prototype.offError = Counterpart.prototype.removeErrorListener = function (callback) {\n  this.removeListener('error', callback);\n};\n\nCounterpart.prototype.translate = function (key, options) {\n  if (!isArray(key) && !isString(key) || !key.length) {\n    throw new Error('invalid argument: key');\n  }\n\n  if (isSymbol(key)) {\n    key = key.substr(1);\n  }\n\n  key = this._registry.keyTransformer(key, options);\n  options = extend(true, {}, options);\n  var locale = options.locale || this._registry.locale;\n  delete options.locale;\n  var scope = options.scope || this._registry.scope;\n  delete options.scope;\n  var separator = options.separator || this._registry.separator;\n  delete options.separator;\n  var fallbackLocales = [].concat(options.fallbackLocale || this._registry.fallbackLocales);\n  delete options.fallbackLocale;\n\n  var keys = this._normalizeKeys(locale, scope, key, separator);\n\n  var entry = getEntry(this._registry.translations, keys);\n\n  if (entry === null) {\n    this.emit('translationnotfound', locale, key, options.fallback, scope);\n\n    if (options.fallback) {\n      entry = this._fallback(locale, scope, key, options.fallback, options);\n    }\n  }\n\n  if (entry === null && fallbackLocales.length > 0 && fallbackLocales.indexOf(locale) === -1) {\n    for (var i = 0, ii = fallbackLocales.length; i < ii; i++) {\n      var fallbackLocale = fallbackLocales[i];\n\n      var fallbackKeys = this._normalizeKeys(fallbackLocale, scope, key, separator);\n\n      entry = getEntry(this._registry.translations, fallbackKeys);\n\n      if (entry) {\n        locale = fallbackLocale;\n        break;\n      }\n    }\n  }\n\n  if (entry === null) {\n    entry = this._registry.generateMissingEntry(keys.join(separator));\n  }\n\n  entry = this._pluralize(locale, entry, options.count);\n\n  if (this._registry.interpolate !== false && options.interpolate !== false) {\n    entry = this._interpolate(entry, options);\n  }\n\n  return entry;\n};\n\nCounterpart.prototype.localize = function (object, options) {\n  if (!isDate(object)) {\n    throw new Error('invalid argument: object must be a date');\n  }\n\n  options = extend(true, {}, options);\n  var locale = options.locale || this._registry.locale;\n  var scope = options.scope || translationScope;\n  var type = options.type || 'datetime';\n  var format = options.format || 'default';\n  options = {\n    locale: locale,\n    scope: scope,\n    interpolate: false\n  };\n  format = this.translate(['formats', type, format], extend(true, {}, options));\n  return strftime(object, format, this.translate('names', options));\n};\n\nCounterpart.prototype._pluralize = function (locale, entry, count) {\n  if (typeof entry !== 'object' || entry === null || typeof count !== 'number') {\n    return entry;\n  }\n\n  var pluralizeFunc = this.translate('pluralize', {\n    locale: locale,\n    scope: translationScope\n  });\n\n  if (Object.prototype.toString.call(pluralizeFunc) !== '[object Function]') {\n    return pluralizeFunc;\n  }\n\n  return pluralizeFunc(entry, count);\n};\n\nCounterpart.prototype.withLocale = function (locale, callback, context) {\n  var previous = this._registry.locale;\n  this._registry.locale = locale;\n  var result = callback.call(context);\n  this._registry.locale = previous;\n  return result;\n};\n\nCounterpart.prototype.withScope = function (scope, callback, context) {\n  var previous = this._registry.scope;\n  this._registry.scope = scope;\n  var result = callback.call(context);\n  this._registry.scope = previous;\n  return result;\n};\n\nCounterpart.prototype.withSeparator = function (separator, callback, context) {\n  var previous = this.setSeparator(separator);\n  var result = callback.call(context);\n  this.setSeparator(previous);\n  return result;\n};\n\nCounterpart.prototype._normalizeKeys = function (locale, scope, key, separator) {\n  var keys = [];\n  keys = keys.concat(this._normalizeKey(locale, separator));\n  keys = keys.concat(this._normalizeKey(scope, separator));\n  keys = keys.concat(this._normalizeKey(key, separator));\n  return keys;\n};\n\nCounterpart.prototype._normalizeKey = function (key, separator) {\n  this._registry.normalizedKeys[separator] = this._registry.normalizedKeys[separator] || {};\n\n  this._registry.normalizedKeys[separator][key] = this._registry.normalizedKeys[separator][key] || function (key) {\n    if (isArray(key)) {\n      var normalizedKeyArray = key.map(function (k) {\n        return this._normalizeKey(k, separator);\n      }.bind(this));\n      return [].concat.apply([], normalizedKeyArray);\n    } else {\n      if (typeof key === 'undefined' || key === null) {\n        return [];\n      }\n\n      var keys = key.split(separator);\n\n      for (var i = keys.length - 1; i >= 0; i--) {\n        if (keys[i] === '') {\n          keys.splice(i, 1);\n\n          if (this._registry.keepTrailingDot === true && i == keys.length) {\n            keys[keys.length - 1] += '' + separator;\n          }\n        }\n      }\n\n      return keys;\n    }\n  }.bind(this)(key);\n\n  return this._registry.normalizedKeys[separator][key];\n};\n\nCounterpart.prototype._interpolate = function (entry, values) {\n  if (typeof entry !== 'string') {\n    return entry;\n  }\n\n  try {\n    return sprintf(entry, extend({}, this._registry.interpolations, values));\n  } catch (err) {\n    if (this.listenerCount('error') > 0) {\n      this.emit('error', err, entry, values);\n    } else {\n      throw err;\n    }\n\n    return null;\n  }\n};\n\nCounterpart.prototype._resolve = function (locale, scope, object, subject, options) {\n  options = options || {};\n\n  if (options.resolve === false) {\n    return subject;\n  }\n\n  var result;\n\n  if (isSymbol(subject)) {\n    result = this.translate(subject, extend({}, options, {\n      locale: locale,\n      scope: scope\n    }));\n  } else if (isFunction(subject)) {\n    var dateOrTime;\n\n    if (options.object) {\n      dateOrTime = options.object;\n      delete options.object;\n    } else {\n      dateOrTime = object;\n    }\n\n    result = this._resolve(locale, scope, object, subject(dateOrTime, options));\n  } else {\n    result = subject;\n  }\n\n  return /^missing translation:/.test(result) ? null : result;\n};\n\nCounterpart.prototype._fallback = function (locale, scope, object, subject, options) {\n  options = except(options, 'fallback');\n\n  if (isArray(subject)) {\n    for (var i = 0, ii = subject.length; i < ii; i++) {\n      var result = this._resolve(locale, scope, object, subject[i], options);\n\n      if (result) {\n        return result;\n      }\n    }\n\n    return null;\n  } else {\n    return this._resolve(locale, scope, object, subject, options);\n  }\n};\n\nvar instance = new Counterpart();\n\nfunction translate() {\n  return instance.translate.apply(instance, arguments);\n}\n\nextend(translate, instance, {\n  Instance: Counterpart,\n  Translator: Counterpart\n});\nmodule.exports = translate;","map":{"version":3,"sources":["/home/artyom/Documents/test/node_modules/counterpart/index.js"],"names":["extend","require","isArray","isDate","sprintf","events","except","strftime","translationScope","isString","val","Object","prototype","toString","call","isFunction","isPlainObject","isSymbol","key","hasOwnProp","obj","hasOwnProperty","getEntry","translations","keys","reduce","result","Counterpart","EventEmitter","apply","_registry","locale","interpolate","fallbackLocales","scope","interpolations","normalizedKeys","separator","keepTrailingDot","keyTransformer","generateMissingEntry","registerTranslations","setMaxListeners","constructor","getLocale","setLocale","value","previous","emit","getFallbackLocale","setFallbackLocale","concat","getAvailableLocales","availableLocales","setAvailableLocales","getSeparator","setSeparator","setInterpolate","getInterpolate","setKeyTransformer","getKeyTransformer","setMissingEntryGenerator","getMissingEntryGenerator","data","registerInterpolations","onLocaleChange","addLocaleChangeListener","callback","addListener","offLocaleChange","removeLocaleChangeListener","removeListener","onTranslationNotFound","addTranslationNotFoundListener","offTranslationNotFound","removeTranslationNotFoundListener","onError","addErrorListener","offError","removeErrorListener","translate","options","length","Error","substr","fallbackLocale","_normalizeKeys","entry","fallback","_fallback","indexOf","i","ii","fallbackKeys","join","_pluralize","count","_interpolate","localize","object","type","format","pluralizeFunc","withLocale","context","withScope","withSeparator","_normalizeKey","normalizedKeyArray","map","k","bind","split","splice","values","err","listenerCount","_resolve","subject","resolve","dateOrTime","test","instance","arguments","Instance","Translator","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar extend  = require('extend');\nvar isArray = require('util').isArray;\nvar isDate  = require('util').isDate;\nvar sprintf = require(\"sprintf-js\").sprintf;\nvar events  = require('events');\nvar except  = require('except');\n\nvar strftime = require('./strftime');\n\nvar translationScope = 'counterpart';\n\nfunction isString(val) {\n  return typeof val === 'string' || Object.prototype.toString.call(val) === '[object String]';\n}\n\nfunction isFunction(val) {\n  return typeof val === 'function' || Object.prototype.toString.call(val) === '[object Function]';\n}\n\nfunction isPlainObject(val) {\n  //Deal with older browsers (IE8) that don't return [object Null] in this case.\n  if (val === null) {\n    return false;\n  }\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\nfunction isSymbol(key) {\n  return isString(key) && key[0] === ':';\n}\n\nfunction hasOwnProp(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction getEntry(translations, keys) {\n  return keys.reduce(function(result, key) {\n    if (isPlainObject(result) && hasOwnProp(result, key)) {\n      return result[key];\n    } else {\n      return null;\n    }\n  }, translations);\n}\n\nfunction Counterpart() {\n  events.EventEmitter.apply(this);\n\n  this._registry = {\n    locale: 'en',\n    interpolate: true,\n    fallbackLocales: [],\n    scope: null,\n    translations: {},\n    interpolations: {},\n    normalizedKeys: {},\n    separator: '.',\n    keepTrailingDot: false,\n    keyTransformer: function(key) { return key; },\n    generateMissingEntry: function(key) { return 'missing translation: ' + key; }\n  };\n\n  this.registerTranslations('en', require('./locales/en'));\n  this.setMaxListeners(0);\n}\n\nCounterpart.prototype = events.EventEmitter.prototype;\nCounterpart.prototype.constructor = events.EventEmitter;\n\nCounterpart.prototype.getLocale = function() {\n  return this._registry.locale;\n};\n\nCounterpart.prototype.setLocale = function(value) {\n  var previous = this._registry.locale;\n\n  if (previous != value) {\n    this._registry.locale = value;\n    this.emit('localechange', value, previous);\n  }\n\n  return previous;\n};\n\nCounterpart.prototype.getFallbackLocale = function() {\n  return this._registry.fallbackLocales;\n};\n\nCounterpart.prototype.setFallbackLocale = function(value) {\n  var previous = this._registry.fallbackLocales;\n  this._registry.fallbackLocales = [].concat(value || []);\n  return previous;\n};\n\nCounterpart.prototype.getAvailableLocales = function() {\n  return this._registry.availableLocales || Object.keys(this._registry.translations);\n};\n\nCounterpart.prototype.setAvailableLocales = function(value) {\n  var previous = this.getAvailableLocales();\n  this._registry.availableLocales = value;\n  return previous;\n};\n\nCounterpart.prototype.getSeparator = function() {\n  return this._registry.separator;\n};\n\nCounterpart.prototype.setSeparator = function(value) {\n  var previous = this._registry.separator;\n  this._registry.separator = value;\n  return previous;\n};\n\nCounterpart.prototype.setInterpolate = function(value) {\n  var previous = this._registry.interpolate;\n  this._registry.interpolate = value;\n  return previous;\n};\n\nCounterpart.prototype.getInterpolate = function() {\n  return this._registry.interpolate;\n};\n\nCounterpart.prototype.setKeyTransformer = function(value) {\n  var previous = this._registry.keyTransformer;\n  this._registry.keyTransformer = value;\n  return previous;\n};\n\nCounterpart.prototype.getKeyTransformer = function() {\n  return this._registry.keyTransformer;\n};\n\nCounterpart.prototype.setMissingEntryGenerator = function(value) {\n  var previous = this._registry.generateMissingEntry;\n  this._registry.generateMissingEntry = value;\n  return previous;\n};\n\nCounterpart.prototype.getMissingEntryGenerator = function() {\n  return this._registry.generateMissingEntry;\n};\n\nCounterpart.prototype.registerTranslations = function(locale, data) {\n  var translations = {};\n  translations[locale] = data;\n  extend(true, this._registry.translations, translations);\n  return translations;\n};\n\nCounterpart.prototype.registerInterpolations = function(data) {\n  return extend(true, this._registry.interpolations, data);\n};\n\nCounterpart.prototype.onLocaleChange =\nCounterpart.prototype.addLocaleChangeListener = function(callback) {\n  this.addListener('localechange', callback);\n};\n\nCounterpart.prototype.offLocaleChange =\nCounterpart.prototype.removeLocaleChangeListener = function(callback) {\n  this.removeListener('localechange', callback);\n};\n\nCounterpart.prototype.onTranslationNotFound =\nCounterpart.prototype.addTranslationNotFoundListener = function(callback) {\n  this.addListener('translationnotfound', callback);\n};\n\nCounterpart.prototype.offTranslationNotFound =\nCounterpart.prototype.removeTranslationNotFoundListener = function(callback) {\n  this.removeListener('translationnotfound', callback);\n};\n\nCounterpart.prototype.onError =\nCounterpart.prototype.addErrorListener = function(callback) {\n  this.addListener('error', callback);\n};\n\nCounterpart.prototype.offError =\nCounterpart.prototype.removeErrorListener = function(callback) {\n  this.removeListener('error', callback);\n};\n\nCounterpart.prototype.translate = function(key, options) {\n  if (!isArray(key) && !isString(key) || !key.length) {\n    throw new Error('invalid argument: key');\n  }\n\n  if (isSymbol(key)) {\n    key = key.substr(1);\n  }\n\n  key = this._registry.keyTransformer(key, options);\n\n  options = extend(true, {}, options);\n\n  var locale = options.locale || this._registry.locale;\n  delete options.locale;\n\n  var scope = options.scope || this._registry.scope;\n  delete options.scope;\n\n  var separator = options.separator || this._registry.separator;\n  delete options.separator;\n\n  var fallbackLocales = [].concat(options.fallbackLocale || this._registry.fallbackLocales);\n  delete options.fallbackLocale;\n\n  var keys = this._normalizeKeys(locale, scope, key, separator);\n\n  var entry = getEntry(this._registry.translations, keys);\n\n  if (entry === null) {\n    this.emit('translationnotfound', locale, key, options.fallback, scope);\n\n    if (options.fallback) {\n      entry = this._fallback(locale, scope, key, options.fallback, options);\n    }\n  }\n\n  if (entry === null && fallbackLocales.length > 0 && fallbackLocales.indexOf(locale) === -1) {\n    for (var i = 0, ii = fallbackLocales.length; i < ii; i++) {\n      var fallbackLocale = fallbackLocales[i];\n      var fallbackKeys = this._normalizeKeys(fallbackLocale, scope, key, separator);\n      entry = getEntry(this._registry.translations, fallbackKeys);\n\n      if (entry) {\n        locale = fallbackLocale;\n        break;\n      }\n    }\n  }\n\n  if (entry === null) {\n    entry = this._registry.generateMissingEntry(keys.join(separator));\n  }\n\n  entry = this._pluralize(locale, entry, options.count);\n\n  if (this._registry.interpolate !== false && options.interpolate !== false) {\n    entry = this._interpolate(entry, options);\n  }\n\n  return entry;\n};\n\nCounterpart.prototype.localize = function(object, options) {\n  if (!isDate(object)) {\n    throw new Error('invalid argument: object must be a date');\n  }\n\n  options = extend(true, {}, options);\n\n  var locale  = options.locale  || this._registry.locale;\n  var scope   = options.scope   || translationScope;\n  var type    = options.type    || 'datetime';\n  var format  = options.format  || 'default';\n\n  options = { locale: locale, scope: scope, interpolate: false };\n  format  = this.translate(['formats', type, format], extend(true, {}, options));\n\n  return strftime(object, format, this.translate('names', options));\n};\n\nCounterpart.prototype._pluralize = function(locale, entry, count) {\n  if (typeof entry !== 'object' || entry === null || typeof count !== 'number') {\n    return entry;\n  }\n\n  var pluralizeFunc = this.translate('pluralize', { locale: locale, scope: translationScope });\n\n  if (Object.prototype.toString.call(pluralizeFunc) !== '[object Function]') {\n    return pluralizeFunc;\n  }\n\n  return pluralizeFunc(entry, count);\n};\n\nCounterpart.prototype.withLocale = function(locale, callback, context) {\n  var previous = this._registry.locale;\n  this._registry.locale = locale;\n  var result = callback.call(context);\n  this._registry.locale = previous;\n  return result;\n};\n\nCounterpart.prototype.withScope = function(scope, callback, context) {\n  var previous = this._registry.scope;\n  this._registry.scope = scope;\n  var result = callback.call(context);\n  this._registry.scope = previous;\n  return result;\n};\n\nCounterpart.prototype.withSeparator = function(separator, callback, context) {\n  var previous = this.setSeparator(separator);\n  var result = callback.call(context);\n  this.setSeparator(previous);\n  return result;\n};\n\nCounterpart.prototype._normalizeKeys = function(locale, scope, key, separator) {\n  var keys = [];\n\n  keys = keys.concat(this._normalizeKey(locale, separator));\n  keys = keys.concat(this._normalizeKey(scope, separator));\n  keys = keys.concat(this._normalizeKey(key, separator));\n\n  return keys;\n};\n\nCounterpart.prototype._normalizeKey = function(key, separator) {\n  this._registry.normalizedKeys[separator] = this._registry.normalizedKeys[separator] || {};\n\n  this._registry.normalizedKeys[separator][key] = this._registry.normalizedKeys[separator][key] || (function(key) {\n    if (isArray(key)) {\n      var normalizedKeyArray = key.map(function(k) { return this._normalizeKey(k, separator); }.bind(this));\n\n      return [].concat.apply([], normalizedKeyArray);\n    } else {\n      if (typeof key === 'undefined' || key === null) {\n        return [];\n      }\n\n      var keys = key.split(separator);\n\n      for (var i = keys.length - 1; i >= 0; i--) {\n        if (keys[i] === '') {\n          keys.splice(i, 1);\n\n          if (this._registry.keepTrailingDot === true && i == keys.length) {\n            keys[keys.length - 1] += '' + separator;\n          }\n        }\n      }\n\n      return keys;\n    }\n  }.bind(this))(key);\n\n  return this._registry.normalizedKeys[separator][key];\n};\n\nCounterpart.prototype._interpolate = function(entry, values) {\n  if (typeof entry !== 'string') {\n    return entry;\n  }\n\n  try {\n    return sprintf(entry, extend({}, this._registry.interpolations, values));\n  } catch (err) {\n    if (this.listenerCount('error') > 0) {\n      this.emit('error', err, entry, values);\n    } else {\n      throw err;\n    }\n    return null;\n  }\n};\n\nCounterpart.prototype._resolve = function(locale, scope, object, subject, options) {\n  options = options || {};\n\n  if (options.resolve === false) {\n    return subject;\n  }\n\n  var result;\n\n  if (isSymbol(subject)) {\n    result = this.translate(subject, extend({}, options, { locale: locale, scope: scope }));\n  } else if (isFunction(subject)) {\n    var dateOrTime;\n\n    if (options.object) {\n      dateOrTime = options.object;\n      delete options.object;\n    } else {\n      dateOrTime = object;\n    }\n\n    result = this._resolve(locale, scope, object, subject(dateOrTime, options));\n  } else {\n    result = subject;\n  }\n\n  return /^missing translation:/.test(result) ? null : result;\n};\n\nCounterpart.prototype._fallback = function(locale, scope, object, subject, options) {\n  options = except(options, 'fallback');\n\n  if (isArray(subject)) {\n    for (var i = 0, ii = subject.length; i < ii; i++) {\n      var result = this._resolve(locale, scope, object, subject[i], options);\n\n      if (result) {\n        return result;\n      }\n    }\n\n    return null;\n  } else {\n    return this._resolve(locale, scope, object, subject, options);\n  }\n};\n\nvar instance = new Counterpart();\n\nfunction translate() {\n  return instance.translate.apply(instance, arguments);\n}\n\nextend(translate, instance, {\n  Instance: Counterpart,\n  Translator: Counterpart\n});\n\nmodule.exports = translate;\n"]},"metadata":{},"sourceType":"script"}